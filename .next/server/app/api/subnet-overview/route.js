"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/subnet-overview/route";
exports.ids = ["app/api/subnet-overview/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsubnet-overview%2Froute&page=%2Fapi%2Fsubnet-overview%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsubnet-overview%2Froute.ts&appDir=%2FUsers%2Fmonkey%2Fafffine-dash-starter%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmonkey%2Fafffine-dash-starter&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsubnet-overview%2Froute&page=%2Fapi%2Fsubnet-overview%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsubnet-overview%2Froute.ts&appDir=%2FUsers%2Fmonkey%2Fafffine-dash-starter%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmonkey%2Fafffine-dash-starter&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_monkey_afffine_dash_starter_app_api_subnet_overview_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/subnet-overview/route.ts */ \"(rsc)/./app/api/subnet-overview/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/subnet-overview/route\",\n        pathname: \"/api/subnet-overview\",\n        filename: \"route\",\n        bundlePath: \"app/api/subnet-overview/route\"\n    },\n    resolvedPagePath: \"/Users/monkey/afffine-dash-starter/app/api/subnet-overview/route.ts\",\n    nextConfigOutput,\n    userland: _Users_monkey_afffine_dash_starter_app_api_subnet_overview_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/subnet-overview/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdWJuZXQtb3ZlcnZpZXclMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN1Ym5ldC1vdmVydmlldyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN1Ym5ldC1vdmVydmlldyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1vbmtleSUyRmFmZmZpbmUtZGFzaC1zdGFydGVyJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRm1vbmtleSUyRmFmZmZpbmUtZGFzaC1zdGFydGVyJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNtQjtBQUNoRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpdGUtcmVhY3QtdHlwZXNjcmlwdC1zdGFydGVyLz83NGZiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9tb25rZXkvYWZmZmluZS1kYXNoLXN0YXJ0ZXIvYXBwL2FwaS9zdWJuZXQtb3ZlcnZpZXcvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3N1Ym5ldC1vdmVydmlldy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3N1Ym5ldC1vdmVydmlld1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc3VibmV0LW92ZXJ2aWV3L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL21vbmtleS9hZmZmaW5lLWRhc2gtc3RhcnRlci9hcHAvYXBpL3N1Ym5ldC1vdmVydmlldy9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvc3VibmV0LW92ZXJ2aWV3L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsubnet-overview%2Froute&page=%2Fapi%2Fsubnet-overview%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsubnet-overview%2Froute.ts&appDir=%2FUsers%2Fmonkey%2Fafffine-dash-starter%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmonkey%2Fafffine-dash-starter&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/subnet-overview/route.ts":
/*!******************************************!*\
  !*** ./app/api/subnet-overview/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n\n\nconst runtime = \"nodejs\";\nconst ENV_WINDOW = \"30 days\";\nfunction buildEnvSelect(envNames) {\n    const joiner = \",\\n        \";\n    return envNames.map((name, index)=>{\n        const alias = name.toLowerCase().replace(/[^a-z0-9_]/g, \"_\");\n        const paramIndex = index + 1;\n        return `MAX(CASE WHEN b.env_name = $${paramIndex} THEN b.avg_score * 100 ELSE NULL END) AS \"${alias}\"`;\n    }).join(joiner);\n}\nasync function GET() {\n    try {\n        const envResult = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(`\n        SELECT DISTINCT env_name\n        FROM public.affine_results\n        WHERE ingested_at > NOW() - INTERVAL '${ENV_WINDOW}'\n        ORDER BY env_name ASC;\n      `);\n        const envNames = envResult.rows.map(({ env_name })=>env_name).filter((name)=>Boolean(name));\n        const dynamicEnvSelect = buildEnvSelect(envNames);\n        const envSelectClause = dynamicEnvSelect ? `${dynamicEnvSelect},\n        ` : \"\";\n        const sql = `\n      WITH\n        base_metrics AS (\n          SELECT\n            hotkey,\n            model,\n            revision,\n            MAX(uid) AS uid,\n            env_name,\n            COUNT(*) AS rollouts,\n            AVG(score) AS avg_score,\n            AVG(latency_seconds) AS avg_latency,\n            (SUM(CASE WHEN success THEN 1 ELSE 0 END)::float / COUNT(*)) * 100 AS success_rate_percent\n          FROM public.affine_results\n          WHERE ingested_at > NOW() - INTERVAL '${ENV_WINDOW}'\n          GROUP BY hotkey, model, revision, env_name\n        ),\n        env_maximums AS (\n          SELECT\n            env_name,\n            MAX(rollouts) AS max_rollouts\n          FROM base_metrics\n          GROUP BY env_name\n        ),\n        eligibility_check AS (\n          SELECT\n            bm.hotkey,\n            bm.model,\n            bm.revision,\n            bool_and(bm.rollouts >= (150 + 0.01 * em.max_rollouts)) AS is_eligible\n          FROM base_metrics bm\n          JOIN env_maximums em ON bm.env_name = em.env_name\n          GROUP BY bm.hotkey, bm.model, bm.revision\n        ),\n        overall_metrics AS (\n          SELECT\n            hotkey,\n            model,\n            revision,\n            COUNT(*) AS total_rollouts,\n            AVG(score) AS overall_avg_score,\n            (SUM(CASE WHEN success THEN 1 ELSE 0 END)::float / COUNT(*)) * 100 AS success_rate_percent,\n            AVG(latency_seconds) AS avg_latency,\n            MAX(ingested_at) AS last_rollout_at,\n            MAX((extra->'miner_chute'->>'chute_id')) AS chute_id\n          FROM public.affine_results\n          WHERE ingested_at > NOW() - INTERVAL '${ENV_WINDOW}'\n          GROUP BY hotkey, model, revision\n        )\n      SELECT\n        b.hotkey,\n        b.model,\n        b.revision AS rev,\n        MAX(b.uid) AS uid,\n        ${envSelectClause}e.is_eligible AS eligible,\n        om.overall_avg_score * 100 AS overall_avg_score,\n        om.success_rate_percent,\n        om.avg_latency,\n        om.total_rollouts,\n        om.last_rollout_at,\n        om.chute_id\n      FROM base_metrics b\n      JOIN eligibility_check e\n        ON b.hotkey = e.hotkey AND b.model = e.model AND b.revision = e.revision\n      JOIN overall_metrics om\n        ON b.hotkey = om.hotkey AND b.model = om.model AND b.revision = om.revision\n      GROUP BY\n        b.hotkey,\n        b.model,\n        b.revision,\n        e.is_eligible,\n        om.overall_avg_score,\n        om.success_rate_percent,\n        om.avg_latency,\n        om.total_rollouts,\n        om.last_rollout_at,\n        om.chute_id\n      ORDER BY om.overall_avg_score DESC;\n    `;\n        const { rows } = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(sql, envNames);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(rows);\n    } catch (error) {\n        console.error(\"Subnet overview query error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"Server Error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3N1Ym5ldC1vdmVydmlldy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTJDO0FBQ1Y7QUFHMUIsTUFBTUUsVUFBVSxTQUFTO0FBRWhDLE1BQU1DLGFBQWE7QUFFbkIsU0FBU0MsZUFBZUMsUUFBa0I7SUFDeEMsTUFBTUMsU0FBUztJQUNmLE9BQU9ELFNBQ0pFLEdBQUcsQ0FBQyxDQUFDQyxNQUFNQztRQUNWLE1BQU1DLFFBQVFGLEtBQUtHLFdBQVcsR0FBR0MsT0FBTyxDQUFDLGVBQWU7UUFDeEQsTUFBTUMsYUFBYUosUUFBUTtRQUMzQixPQUFPLENBQUMsNEJBQTRCLEVBQUVJLFdBQVcsMkNBQTJDLEVBQUVILE1BQU0sQ0FBQyxDQUFDO0lBQ3hHLEdBQ0NJLElBQUksQ0FBQ1I7QUFDVjtBQUVPLGVBQWVTO0lBQ3BCLElBQUk7UUFDRixNQUFNQyxZQUFZLE1BQU1mLDhDQUFLQSxDQUMzQixDQUFDOzs7OENBR3VDLEVBQUVFLFdBQVc7O01BRXJELENBQUM7UUFHSCxNQUFNRSxXQUFXVyxVQUFVQyxJQUFJLENBQzVCVixHQUFHLENBQUMsQ0FBQyxFQUFFVyxRQUFRLEVBQXdCLEdBQUtBLFVBQzVDQyxNQUFNLENBQUMsQ0FBQ1gsT0FBb0RZLFFBQVFaO1FBRXZFLE1BQU1hLG1CQUFtQmpCLGVBQWVDO1FBQ3hDLE1BQU1pQixrQkFBa0JELG1CQUNwQixDQUFDLEVBQUVBLGlCQUFpQjtRQUNwQixDQUFDLEdBQ0Q7UUFFSixNQUFNRSxNQUFNLENBQUM7Ozs7Ozs7Ozs7Ozs7O2dEQWMrQixFQUFFcEIsV0FBVzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Z0RBZ0NiLEVBQUVBLFdBQVc7Ozs7Ozs7O1FBUXJELEVBQUVtQixnQkFBZ0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQXdCdEIsQ0FBQztRQUVELE1BQU0sRUFBRUwsSUFBSSxFQUFFLEdBQUcsTUFBTWhCLDhDQUFLQSxDQUFvQnNCLEtBQUtsQjtRQUNyRCxPQUFPTCxxREFBWUEsQ0FBQ3dCLElBQUksQ0FBQ1A7SUFDM0IsRUFBRSxPQUFPUSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxnQ0FBZ0NBO1FBQzlDLE9BQU96QixxREFBWUEsQ0FBQ3dCLElBQUksQ0FBQztZQUFFRyxTQUFTO1FBQWUsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDdEU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpdGUtcmVhY3QtdHlwZXNjcmlwdC1zdGFydGVyLy4vYXBwL2FwaS9zdWJuZXQtb3ZlcnZpZXcvcm91dGUudHM/MzQ5NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBxdWVyeSB9IGZyb20gJ0AvbGliL2RiJztcbmltcG9ydCB0eXBlIHsgU3VibmV0T3ZlcnZpZXdSb3cgfSBmcm9tICdAL2xpYi90eXBlcyc7XG5cbmV4cG9ydCBjb25zdCBydW50aW1lID0gJ25vZGVqcyc7XG5cbmNvbnN0IEVOVl9XSU5ET1cgPSAnMzAgZGF5cyc7XG5cbmZ1bmN0aW9uIGJ1aWxkRW52U2VsZWN0KGVudk5hbWVzOiBzdHJpbmdbXSkge1xuICBjb25zdCBqb2luZXIgPSAnLFxcbiAgICAgICAgJztcbiAgcmV0dXJuIGVudk5hbWVzXG4gICAgLm1hcCgobmFtZSwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IGFsaWFzID0gbmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05X10vZywgJ18nKTtcbiAgICAgIGNvbnN0IHBhcmFtSW5kZXggPSBpbmRleCArIDE7XG4gICAgICByZXR1cm4gYE1BWChDQVNFIFdIRU4gYi5lbnZfbmFtZSA9ICQke3BhcmFtSW5kZXh9IFRIRU4gYi5hdmdfc2NvcmUgKiAxMDAgRUxTRSBOVUxMIEVORCkgQVMgXCIke2FsaWFzfVwiYDtcbiAgICB9KVxuICAgIC5qb2luKGpvaW5lcik7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgZW52UmVzdWx0ID0gYXdhaXQgcXVlcnk8eyBlbnZfbmFtZTogc3RyaW5nIH0+KFxuICAgICAgYFxuICAgICAgICBTRUxFQ1QgRElTVElOQ1QgZW52X25hbWVcbiAgICAgICAgRlJPTSBwdWJsaWMuYWZmaW5lX3Jlc3VsdHNcbiAgICAgICAgV0hFUkUgaW5nZXN0ZWRfYXQgPiBOT1coKSAtIElOVEVSVkFMICcke0VOVl9XSU5ET1d9J1xuICAgICAgICBPUkRFUiBCWSBlbnZfbmFtZSBBU0M7XG4gICAgICBgLFxuICAgICk7XG5cbiAgICBjb25zdCBlbnZOYW1lcyA9IGVudlJlc3VsdC5yb3dzXG4gICAgICAubWFwKCh7IGVudl9uYW1lIH06IHsgZW52X25hbWU6IHN0cmluZyB9KSA9PiBlbnZfbmFtZSlcbiAgICAgIC5maWx0ZXIoKG5hbWU6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBuYW1lIGlzIHN0cmluZyA9PiBCb29sZWFuKG5hbWUpKTtcblxuICAgIGNvbnN0IGR5bmFtaWNFbnZTZWxlY3QgPSBidWlsZEVudlNlbGVjdChlbnZOYW1lcyk7XG4gICAgY29uc3QgZW52U2VsZWN0Q2xhdXNlID0gZHluYW1pY0VudlNlbGVjdFxuICAgICAgPyBgJHtkeW5hbWljRW52U2VsZWN0fSxcbiAgICAgICAgYFxuICAgICAgOiAnJztcblxuICAgIGNvbnN0IHNxbCA9IGBcbiAgICAgIFdJVEhcbiAgICAgICAgYmFzZV9tZXRyaWNzIEFTIChcbiAgICAgICAgICBTRUxFQ1RcbiAgICAgICAgICAgIGhvdGtleSxcbiAgICAgICAgICAgIG1vZGVsLFxuICAgICAgICAgICAgcmV2aXNpb24sXG4gICAgICAgICAgICBNQVgodWlkKSBBUyB1aWQsXG4gICAgICAgICAgICBlbnZfbmFtZSxcbiAgICAgICAgICAgIENPVU5UKCopIEFTIHJvbGxvdXRzLFxuICAgICAgICAgICAgQVZHKHNjb3JlKSBBUyBhdmdfc2NvcmUsXG4gICAgICAgICAgICBBVkcobGF0ZW5jeV9zZWNvbmRzKSBBUyBhdmdfbGF0ZW5jeSxcbiAgICAgICAgICAgIChTVU0oQ0FTRSBXSEVOIHN1Y2Nlc3MgVEhFTiAxIEVMU0UgMCBFTkQpOjpmbG9hdCAvIENPVU5UKCopKSAqIDEwMCBBUyBzdWNjZXNzX3JhdGVfcGVyY2VudFxuICAgICAgICAgIEZST00gcHVibGljLmFmZmluZV9yZXN1bHRzXG4gICAgICAgICAgV0hFUkUgaW5nZXN0ZWRfYXQgPiBOT1coKSAtIElOVEVSVkFMICcke0VOVl9XSU5ET1d9J1xuICAgICAgICAgIEdST1VQIEJZIGhvdGtleSwgbW9kZWwsIHJldmlzaW9uLCBlbnZfbmFtZVxuICAgICAgICApLFxuICAgICAgICBlbnZfbWF4aW11bXMgQVMgKFxuICAgICAgICAgIFNFTEVDVFxuICAgICAgICAgICAgZW52X25hbWUsXG4gICAgICAgICAgICBNQVgocm9sbG91dHMpIEFTIG1heF9yb2xsb3V0c1xuICAgICAgICAgIEZST00gYmFzZV9tZXRyaWNzXG4gICAgICAgICAgR1JPVVAgQlkgZW52X25hbWVcbiAgICAgICAgKSxcbiAgICAgICAgZWxpZ2liaWxpdHlfY2hlY2sgQVMgKFxuICAgICAgICAgIFNFTEVDVFxuICAgICAgICAgICAgYm0uaG90a2V5LFxuICAgICAgICAgICAgYm0ubW9kZWwsXG4gICAgICAgICAgICBibS5yZXZpc2lvbixcbiAgICAgICAgICAgIGJvb2xfYW5kKGJtLnJvbGxvdXRzID49ICgxNTAgKyAwLjAxICogZW0ubWF4X3JvbGxvdXRzKSkgQVMgaXNfZWxpZ2libGVcbiAgICAgICAgICBGUk9NIGJhc2VfbWV0cmljcyBibVxuICAgICAgICAgIEpPSU4gZW52X21heGltdW1zIGVtIE9OIGJtLmVudl9uYW1lID0gZW0uZW52X25hbWVcbiAgICAgICAgICBHUk9VUCBCWSBibS5ob3RrZXksIGJtLm1vZGVsLCBibS5yZXZpc2lvblxuICAgICAgICApLFxuICAgICAgICBvdmVyYWxsX21ldHJpY3MgQVMgKFxuICAgICAgICAgIFNFTEVDVFxuICAgICAgICAgICAgaG90a2V5LFxuICAgICAgICAgICAgbW9kZWwsXG4gICAgICAgICAgICByZXZpc2lvbixcbiAgICAgICAgICAgIENPVU5UKCopIEFTIHRvdGFsX3JvbGxvdXRzLFxuICAgICAgICAgICAgQVZHKHNjb3JlKSBBUyBvdmVyYWxsX2F2Z19zY29yZSxcbiAgICAgICAgICAgIChTVU0oQ0FTRSBXSEVOIHN1Y2Nlc3MgVEhFTiAxIEVMU0UgMCBFTkQpOjpmbG9hdCAvIENPVU5UKCopKSAqIDEwMCBBUyBzdWNjZXNzX3JhdGVfcGVyY2VudCxcbiAgICAgICAgICAgIEFWRyhsYXRlbmN5X3NlY29uZHMpIEFTIGF2Z19sYXRlbmN5LFxuICAgICAgICAgICAgTUFYKGluZ2VzdGVkX2F0KSBBUyBsYXN0X3JvbGxvdXRfYXQsXG4gICAgICAgICAgICBNQVgoKGV4dHJhLT4nbWluZXJfY2h1dGUnLT4+J2NodXRlX2lkJykpIEFTIGNodXRlX2lkXG4gICAgICAgICAgRlJPTSBwdWJsaWMuYWZmaW5lX3Jlc3VsdHNcbiAgICAgICAgICBXSEVSRSBpbmdlc3RlZF9hdCA+IE5PVygpIC0gSU5URVJWQUwgJyR7RU5WX1dJTkRPV30nXG4gICAgICAgICAgR1JPVVAgQlkgaG90a2V5LCBtb2RlbCwgcmV2aXNpb25cbiAgICAgICAgKVxuICAgICAgU0VMRUNUXG4gICAgICAgIGIuaG90a2V5LFxuICAgICAgICBiLm1vZGVsLFxuICAgICAgICBiLnJldmlzaW9uIEFTIHJldixcbiAgICAgICAgTUFYKGIudWlkKSBBUyB1aWQsXG4gICAgICAgICR7ZW52U2VsZWN0Q2xhdXNlfWUuaXNfZWxpZ2libGUgQVMgZWxpZ2libGUsXG4gICAgICAgIG9tLm92ZXJhbGxfYXZnX3Njb3JlICogMTAwIEFTIG92ZXJhbGxfYXZnX3Njb3JlLFxuICAgICAgICBvbS5zdWNjZXNzX3JhdGVfcGVyY2VudCxcbiAgICAgICAgb20uYXZnX2xhdGVuY3ksXG4gICAgICAgIG9tLnRvdGFsX3JvbGxvdXRzLFxuICAgICAgICBvbS5sYXN0X3JvbGxvdXRfYXQsXG4gICAgICAgIG9tLmNodXRlX2lkXG4gICAgICBGUk9NIGJhc2VfbWV0cmljcyBiXG4gICAgICBKT0lOIGVsaWdpYmlsaXR5X2NoZWNrIGVcbiAgICAgICAgT04gYi5ob3RrZXkgPSBlLmhvdGtleSBBTkQgYi5tb2RlbCA9IGUubW9kZWwgQU5EIGIucmV2aXNpb24gPSBlLnJldmlzaW9uXG4gICAgICBKT0lOIG92ZXJhbGxfbWV0cmljcyBvbVxuICAgICAgICBPTiBiLmhvdGtleSA9IG9tLmhvdGtleSBBTkQgYi5tb2RlbCA9IG9tLm1vZGVsIEFORCBiLnJldmlzaW9uID0gb20ucmV2aXNpb25cbiAgICAgIEdST1VQIEJZXG4gICAgICAgIGIuaG90a2V5LFxuICAgICAgICBiLm1vZGVsLFxuICAgICAgICBiLnJldmlzaW9uLFxuICAgICAgICBlLmlzX2VsaWdpYmxlLFxuICAgICAgICBvbS5vdmVyYWxsX2F2Z19zY29yZSxcbiAgICAgICAgb20uc3VjY2Vzc19yYXRlX3BlcmNlbnQsXG4gICAgICAgIG9tLmF2Z19sYXRlbmN5LFxuICAgICAgICBvbS50b3RhbF9yb2xsb3V0cyxcbiAgICAgICAgb20ubGFzdF9yb2xsb3V0X2F0LFxuICAgICAgICBvbS5jaHV0ZV9pZFxuICAgICAgT1JERVIgQlkgb20ub3ZlcmFsbF9hdmdfc2NvcmUgREVTQztcbiAgICBgO1xuXG4gICAgY29uc3QgeyByb3dzIH0gPSBhd2FpdCBxdWVyeTxTdWJuZXRPdmVydmlld1Jvdz4oc3FsLCBlbnZOYW1lcyk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJvd3MpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1N1Ym5ldCBvdmVydmlldyBxdWVyeSBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgbWVzc2FnZTogJ1NlcnZlciBFcnJvcicgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInF1ZXJ5IiwicnVudGltZSIsIkVOVl9XSU5ET1ciLCJidWlsZEVudlNlbGVjdCIsImVudk5hbWVzIiwiam9pbmVyIiwibWFwIiwibmFtZSIsImluZGV4IiwiYWxpYXMiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJwYXJhbUluZGV4Iiwiam9pbiIsIkdFVCIsImVudlJlc3VsdCIsInJvd3MiLCJlbnZfbmFtZSIsImZpbHRlciIsIkJvb2xlYW4iLCJkeW5hbWljRW52U2VsZWN0IiwiZW52U2VsZWN0Q2xhdXNlIiwic3FsIiwianNvbiIsImVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/subnet-overview/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction getPool() {\n    if (!globalThis.__affineDbPool) {\n        const connectionString = process.env.DATABASE_URL;\n        if (!connectionString) {\n            throw new Error(\"DATABASE_URL env var is not set\");\n        }\n        globalThis.__affineDbPool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            connectionString,\n            ssl: {\n                rejectUnauthorized: false\n            },\n            max: 5,\n            idleTimeoutMillis: 30000,\n            connectionTimeoutMillis: 10000\n        });\n        globalThis.__affineDbPool.on(\"error\", (err)=>{\n            console.error(\"Postgres pool error\", err);\n        });\n    }\n    return globalThis.__affineDbPool;\n}\nasync function query(text, params = []) {\n    const client = getPool();\n    return client.query(text, params);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXVDO0FBT3ZDLFNBQVNDO0lBQ1AsSUFBSSxDQUFDQyxXQUFXQyxjQUFjLEVBQUU7UUFDOUIsTUFBTUMsbUJBQW1CQyxRQUFRQyxHQUFHLENBQUNDLFlBQVk7UUFDakQsSUFBSSxDQUFDSCxrQkFBa0I7WUFDckIsTUFBTSxJQUFJSSxNQUFNO1FBQ2xCO1FBQ0FOLFdBQVdDLGNBQWMsR0FBRyxJQUFJSCxvQ0FBSUEsQ0FBQztZQUNuQ0k7WUFDQUssS0FBSztnQkFBRUMsb0JBQW9CO1lBQU07WUFDakNDLEtBQUs7WUFDTEMsbUJBQW1CO1lBQ25CQyx5QkFBeUI7UUFDM0I7UUFDQVgsV0FBV0MsY0FBYyxDQUFDVyxFQUFFLENBQUMsU0FBUyxDQUFDQztZQUNyQ0MsUUFBUUMsS0FBSyxDQUFDLHVCQUF1QkY7UUFDdkM7SUFDRjtJQUNBLE9BQU9iLFdBQVdDLGNBQWM7QUFDbEM7QUFFTyxlQUFlZSxNQUFtQkMsSUFBWSxFQUFFQyxTQUFvQixFQUFFO0lBQzNFLE1BQU1DLFNBQVNwQjtJQUNmLE9BQU9vQixPQUFPSCxLQUFLLENBQUlDLE1BQU1DO0FBQy9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdml0ZS1yZWFjdC10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9saWIvZGIudHM/MWRmMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb29sLCBRdWVyeVJlc3VsdCB9IGZyb20gJ3BnJztcblxuZGVjbGFyZSBnbG9iYWwge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXG4gIHZhciBfX2FmZmluZURiUG9vbDogUG9vbCB8IHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gZ2V0UG9vbCgpOiBQb29sIHtcbiAgaWYgKCFnbG9iYWxUaGlzLl9fYWZmaW5lRGJQb29sKSB7XG4gICAgY29uc3QgY29ubmVjdGlvblN0cmluZyA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTDtcbiAgICBpZiAoIWNvbm5lY3Rpb25TdHJpbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignREFUQUJBU0VfVVJMIGVudiB2YXIgaXMgbm90IHNldCcpO1xuICAgIH1cbiAgICBnbG9iYWxUaGlzLl9fYWZmaW5lRGJQb29sID0gbmV3IFBvb2woe1xuICAgICAgY29ubmVjdGlvblN0cmluZyxcbiAgICAgIHNzbDogeyByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlIH0sXG4gICAgICBtYXg6IDUsXG4gICAgICBpZGxlVGltZW91dE1pbGxpczogMzBfMDAwLFxuICAgICAgY29ubmVjdGlvblRpbWVvdXRNaWxsaXM6IDEwXzAwMCxcbiAgICB9KTtcbiAgICBnbG9iYWxUaGlzLl9fYWZmaW5lRGJQb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Bvc3RncmVzIHBvb2wgZXJyb3InLCBlcnIpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBnbG9iYWxUaGlzLl9fYWZmaW5lRGJQb29sO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcXVlcnk8VCA9IHVua25vd24+KHRleHQ6IHN0cmluZywgcGFyYW1zOiB1bmtub3duW10gPSBbXSk6IFByb21pc2U8UXVlcnlSZXN1bHQ8VD4+IHtcbiAgY29uc3QgY2xpZW50ID0gZ2V0UG9vbCgpO1xuICByZXR1cm4gY2xpZW50LnF1ZXJ5PFQ+KHRleHQsIHBhcmFtcyBhcyBhbnlbXSk7XG59XG4iXSwibmFtZXMiOlsiUG9vbCIsImdldFBvb2wiLCJnbG9iYWxUaGlzIiwiX19hZmZpbmVEYlBvb2wiLCJjb25uZWN0aW9uU3RyaW5nIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsIkVycm9yIiwic3NsIiwicmVqZWN0VW5hdXRob3JpemVkIiwibWF4IiwiaWRsZVRpbWVvdXRNaWxsaXMiLCJjb25uZWN0aW9uVGltZW91dE1pbGxpcyIsIm9uIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwicXVlcnkiLCJ0ZXh0IiwicGFyYW1zIiwiY2xpZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsubnet-overview%2Froute&page=%2Fapi%2Fsubnet-overview%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsubnet-overview%2Froute.ts&appDir=%2FUsers%2Fmonkey%2Fafffine-dash-starter%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmonkey%2Fafffine-dash-starter&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();